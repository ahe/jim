<h2 class="project_name">Sammy</h2>
<h2>Documentation</h2>
<h3>Routes</h3>
<p>The main building block of a Sammy application is a set of routes. A route is made up of three simple pieces:</p>
<ul>
	<li>A verb <em>(get, post, put, delete)</em></li>
	<li>A path <em>(#/, test/path/, #/my</em>path/:var)_</li>
	<li>A callback <em>(function() {&#8230;})</em></li>
</ul>
<p>Inside the Sammy.Application block, Routes can be defined in two ways: Using <code>route</code> directly or using the verb shortcuts.</p>
<p>Directly:</p>
<div class="highlight"><pre><span class="c">// route(verb, path, callback)</span><br />
<span class="nx">route</span><span class="p">(</span><span class="s1">&#39;get&#39;</span><span class="o">,</span> <span class="s1">&#39;#/&#39;</span><span class="o">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <br />
  <span class="p">&#8230;</span><br />
<span class="p">});</span><br />
</pre></div>
<p>Equivilent to:</p>
<div class="highlight"><pre><span class="c">// verb(path, callback)</span><br />
<span class="nx">get</span><span class="p">(</span><span class="s1">&#39;#/&#39;</span><span class="o">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <br />
  <span class="p">&#8230;</span><br />
<span class="p">});</span><br />
</pre></div>
<h4>Verbs</h4>
<p>Out of the 4 verbs, <code>get</code> is the most common. <code>get</code> routes are invoked whenever the <span class="caps">URL</span> or <span class="caps">URL</span> hash changes. If the <span class="caps">URL</span> or hash matches one of the route paths, the callback for that route is invoked.</p>
<p><code>post</code>, <code>put</code>, and <code>delete</code> are only invoked by submitted forms. At <code>run()</code> Sammy binds events to <code>submit()</code> for all the forms. When a form is submitted, Sammy looks for a route that matches the path of the form (the action) and the verb (the method). If a route is found, the callback is executed.</p>
<p>For example, this route:</p>
<div class="highlight"><pre><span class="nx">put</span><span class="p">(</span><span class="s1">&#39;#/post/form&#39;</span><span class="o">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <br />
  <span class="p">&#8230;</span><br />
  <span class="k">return</span> <span class="kc">false</span><span class="o">;</span><br />
<span class="p">});</span><br />
</pre></div>
<p>Would be executed when this form is submitted:</p>
<div class="highlight"><pre><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;#/post/form&quot;</span> <span class="na">method=</span><span class="s">&quot;<span class="caps">PUT</span>&quot;</span><span class="nt">&gt;</span><br />
  <span class="nt">&lt;label&gt;</span>First Name<span class="nt">&lt;/label&gt;&lt;br</span> <span class="nt">/&gt;</span><br />
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">name=</span><span class="s">&quot;first_name&quot;</span> <span class="nt">/&gt;</span><br />
  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Submit&quot;</span> <span class="nt">/&gt;</span><br />
<span class="nt">&lt;/form&gt;</span><br />
</pre></div>
<p>If you don&#8217;t want to actually sumbit the form (allow its default behavior), you must return <code>false</code> from the matching routes callback.</p>
<h4>Paths</h4>
<p>Paths can be either full URIs (eg. /blah/blah/blah) or just the end hash (eg. #/mypath). The benefit of using the hash, is that you can define a single page application (no full refreshes) that preserves the back button/history.</p>
<p>Paths can be defined as strings or regular expressions. In fact internally, all paths are converted to regular expressions. That means these are equivilent:</p>
<div class="highlight"><pre><span class="c">// string</span><br />
<span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/test/123&#39;</span><span class="o">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <br />
  <span class="p">&#8230;</span><br />
<span class="p">});</span><br />
<br />
<span class="c">// regexp</span><br />
<span class="nx">get</span><span class="p">(</span><span class="sr">/^\/test\/123/</span><span class="o">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <br />
  <span class="p">&#8230;</span><br />
<span class="p">});</span><br />
</pre></div>
<p>Sammy also parses the path for named and un-named params. This means you can pull things like &#8217;id&#8217;s and &#8217;slug&#8217;s out of the path for dyamic parsing.</p>
<p>Any string starting with <code>:</code> in a path will be pulled out and converted to a named param.</p>
<p>Given an app with this route:</p>
<div class="highlight"><pre><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;#/by_name/:name&#39;</span><span class="o">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="kd">with</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">{</span><br />
  <span class="nx">alert</span><span class="p">(</span><span class="nx">params</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span><br />
<span class="p">}});</span><br />
</pre></div>
<p>Pointing the browser to <code>#/by_name/quirkey</code> would give you the fabulous system prompt reading &#8216;quirkey&#8217;.</p>
<p>This works with mulitple params in a single path. It does not work if you want to match strings that contain &#8216;/&#8217;. If you want that you can use Regexp and &#8216;splat&#8217;.</p>
<p>Given a Regexp route:<br />
<div class="highlight"><pre><span class="nx">get</span><span class="p">(</span><span class="sr">/\#\/by_name\/(.*)/</span><span class="o">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="kd">with</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">{</span><br />
  <span class="nx">alert</span><span class="p">(</span><span class="nx">params</span><span class="p">[</span><span class="s1">&#39;splat&#39;</span><span class="p">]);</span><br />
<span class="p">}});</span><br />
</pre></div></p>
<p>Going to <code>#/by_name/quirkey</code> will give you that same wonderful alert. However, because the regex is more lenient. <code>#/by_name/quirkey/boosh</code> will also assign<br />
<code>quirkey/boosh</code> to splat. Using the Regexp in this way is useful for defining routes where you need more control over.</p>
<h4>Callbacks</h4>
<p>Callbacks are just anonymous javascript functions passed to a route. They are only invoked when the route is matched.</p>
<p>Inside of the callback, the <code>this</code> is a new <code>Sammy.EventContext</code>. Event context has a number of useful methods as well as some important attributes. <a href="api.html">See the <span class="caps">API</span> for the full details.</a></p>
<p>For example, you can access the <code>params</code>, the current path (<code>path</code>), etc. More importantly you can run any jQuery methods or methods of the EventContext like <code>template</code>, <code>partial</code>, <code>redirect</code>, etc.</p>
<p>A helpful convention is wrapping the context in <code>with</code> so that you dont have to always refer to <code>this</code> when invoking methods or getting params.</p>
<p>These are equivilent:</p>
<div class="highlight"><pre><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;#/by_name/:name&#39;</span><span class="o">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="kd">with</span><span class="p">(</span><span class="k">this</span><span class="p">)</span> <span class="p">{</span><br />
  <span class="nx">redirect</span><span class="p">(</span><span class="s1">&#39;#/&#39;</span> <span class="o">+</span> <span class="nx">params</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span><br />
<span class="p">}});</span><br />
<br />
<span class="nx">get</span><span class="p">(</span><span class="s1">&#39;#/by_name/:name&#39;</span><span class="o">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span><br />
  <span class="k">this</span><span class="p">.</span><span class="nx">redirect</span><span class="p">(</span><span class="s1">&#39;#/&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">params</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span><br />
<span class="p">});</span><br />
</pre></div>